<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDCULT Distribution beta - Форма отгрузки релизов</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #000;
            color: #fff;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #111;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(255,255,255,0.1);
        }

        .header h1 {
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            margin: 0;
        }

        .header .beta {
            color: #aaa;
            font-size: 14px;
            font-weight: normal;
            margin-left: 10px;
        }

        .header p {
            color: #ccc;
            font-size: 16px;
            margin-top: 10px;
            width: 100%;
            text-align: center;
        }

        .form-container {
            background-color: #111;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(255,255,255,0.1);
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #fff;
        }

        .required::after {
            content: " *";
            color: red;
        }

        input[type="text"],
        input[type="url"],
        input[type="date"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #444;
            border-radius: 8px;
            font-size: 16px;
            background-color: #222;
            color: #fff;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="url"]:focus,
        input[type="date"]:focus,
        textarea:focus {
            outline: none;
            border-color: #4a90e2;
            background-color: #333;
        }

        /* Стили для прямоугольных кнопок выбора */
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 8px;
        }

        .btn-choice {
            padding: 12px 20px;
            background-color: #222;
            color: #fff;
            border: 1px solid #444;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 16px;
            flex: 1 1 calc(33.333% - 10px);
            min-width: 100px;
        }

        .btn-choice:hover {
            background-color: #333;
        }

        .btn-choice.selected {
            background-color: #fff; /* Белый цвет при выборе */
            color: #000; /* Черный текст */
            border-color: #fff;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background-color: #fff; /* Кнопка белая */
            color: #000; /* Текст черный */
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background-color: #ddd;
        }

        .support-btn {
            width: 100%;
            padding: 15px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }

        .support-btn:hover {
            background-color: #666;
        }

        /* --- НОВЫЙ СТИЛЬ ДЛЯ КНОПКИ СТАТУСА --- */
        .status-btn {
            width: 100%;
            padding: 15px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }

        .status-btn:hover {
            background-color: #666;
        }

        .transfer-fields {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background-color: #222;
            border-radius: 8px;
        }

        .agreement {
            margin-top: 20px;
            padding: 15px;
            background-color: #222;
            border-radius: 8px;
        }

        .agreement label {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .agreement input[type="checkbox"] {
            margin-top: 3px;
        }

        .file-requirements {
            background-color: #222;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
        }

        .profile-input {
            display: none;
            margin-top: 10px;
        }

        .profile-input input {
            width: 100%;
            padding: 8px;
            border: 1px solid #555;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
        }

        @media (max-width: 480px) {
            body {
                padding: 15px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .submit-btn, .support-btn, .status-btn {
                padding: 12px;
                font-size: 16px;
            }
            
            .btn-choice {
                flex: 1 1 calc(50% - 10px);
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CDCULT Distribution</h1>
        <span class="beta">beta</span>
    </div>
    <div style="text-align: center; color: #ccc; margin-bottom: 20px;">Форма отгрузки релизов</div>

    <div class="form-container">
        <form id="distributionForm">
            <!-- Основные артисты -->
            <div class="form-group">
                <label for="artists" class="required">Основные артист(-ы)</label>
                <input type="text" id="artists" name="artists" placeholder="Ваш ответ" required>
            </div>

            <!-- Тип релиза (прямоугольные кнопки) -->
            <div class="form-group">
                <label class="required">Тип релиза</label>
                <div class="button-group" data-group="releaseType">
                    <div class="btn-choice" data-value="Single">Сингл</div>
                    <div class="btn-choice" data-value="EP">EP</div>
                    <div class="btn-choice" data-value="Album">Альбом</div>
                </div>
                <input type="hidden" id="releaseType" name="releaseType" required>
            </div>

            <!-- Название релиза -->
            <div class="form-group">
                <label for="releaseName" class="required">Название релиза</label>
                <input type="text" id="releaseName" name="releaseName" placeholder="Ваш ответ" required>
            </div>

            <!-- Названия треков -->
            <div class="form-group">
                <label for="trackNames">Названия треков</label>
                <textarea id="trackNames" name="trackNames" rows="4" placeholder="Например: 1. Никнейм - Название, 2. Никнейм - Название... Если вы переносите трек - оставьте ISRC в доп. комментариях"></textarea>
            </div>

            <!-- Подзаголовок -->
            <div class="form-group">
                <label for="subtitle">Подзаголовок (speed up, slowed и ТД.)</label>
                <input type="text" id="subtitle" name="subtitle" placeholder="Ваш ответ">
            </div>

            <!-- Перенос или перезаливание (прямоугольные кнопки) -->
            <div class="form-group">
                <label class="required">Вы переносите или перезаливаете релиз</label>
                <div class="button-group" data-group="transfer">
                    <div class="btn-choice" data-value="Да">Да</div>
                    <div class="btn-choice" data-value="Нет, релиз новый">Нет, релиз новый</div>
                </div>
                <input type="hidden" id="transfer" name="transfer" required>
                <div class="transfer-fields" id="transferFields">
                    <div class="form-group">
                        <label for="upc">UPC</label>
                        <input type="text" id="upc" name="upc" placeholder="Ваш ответ">
                    </div>
                    <div class="form-group">
                        <label for="originalReleaseDate">Дата оригинального релиза</label>
                        <input type="date" id="originalReleaseDate" name="originalReleaseDate">
                    </div>
                </div>
            </div>

            <!-- Жанр релиза -->
            <div class="form-group">
                <label for="genre" class="required">Жанр релиза</label>
                <input type="text" id="genre" name="genre" placeholder="Ваш ответ" required>
            </div>

            <!-- Дата выхода -->
            <div class="form-group">
                <label for="releaseDate" class="required">Дата, когда должен выйти релиз (от 3 дней)</label>
                <input type="date" id="releaseDate" name="releaseDate" required>
            </div>

            <!-- ФИО автора текста -->
            <div class="form-group">
                <label for="lyricist" class="required">ФИО автора(-ов) текста (поставьте "-" если трек инструментал)</label>
                <input type="text" id="lyricist" name="lyricist" placeholder="Ваш ответ" required>
            </div>

            <!-- ФИО автора инструментала -->
            <div class="form-group">
                <label for="composer" class="required">ФИО автора(-ов) инструментала</label>
                <input type="text" id="composer" name="composer" placeholder="Ваш ответ" required>
            </div>

            <!-- Ненормативная лексика (прямоугольные кнопки) -->
            <div class="form-group">
                <label class="required">Ненормативная лексика</label>
                <div class="button-group" data-group="profanity">
                    <div class="btn-choice" data-value="Есть">Есть</div>
                    <div class="btn-choice" data-value="Нету">Нету</div>
                </div>
                <input type="hidden" id="profanity" name="profanity" required>
            </div>

            <!-- Ссылка на архив -->
            <div class="form-group">
                <label for="archiveLink" class="required">Ссылка на архив с файлами</label>
                <input type="url" id="archiveLink" name="archiveLink" placeholder="Ваш ответ" required>
                <div class="file-requirements">
                    <strong>Требования к файлам для проверки и загрузки вашего релиза:</strong><br>
                    • Аудио: .wav (16 бит, 44.1 кГц) или .flac<br>
                    • Обложка: .jpg (разрешение 1440x1440 или 3000x3000). Конвертировать - <a href="https://vk.cc/cOgtL9" target="_blank" style="color: #4a90e2;">https://vk.cc/cOgtL9</a><br>
                    • Видеозапись проекта 30 секунд (ОБЯЗАТЕЛЬНО!!! Без видеозаписи релиз не будет приниматься)<br>
                    • Пример названия файла: 1. Никнейм-Название.wav
                </div>
            </div>

            <!-- Spotify профиль -->
            <div class="form-group">
                <label class="required">Карточка/профиль артиста в Spotify</label>
                <div class="button-group" data-group="spotifyProfile">
                    <div class="btn-choice" data-value="Есть">Есть</div>
                    <div class="btn-choice" data-value="Нету, нужно создать">Нету, нужно создать</div>
                    <div class="btn-choice" data-value="Уже указывал">Уже указывал</div>
                </div>
                <input type="hidden" id="spotifyProfile" name="spotifyProfile" required>
                <div class="profile-input" id="spotifyInput">
                    <input type="text" id="spotifyProfileUrl" name="spotifyProfileUrl" placeholder="Ссылка">
                </div>
            </div>

            <!-- Apple Music профиль -->
            <div class="form-group">
                <label>Карточка/профиль артиста в Apple Music</label>
                <div class="button-group" data-group="appleProfile">
                    <div class="btn-choice" data-value="Есть">Есть</div>
                    <div class="btn-choice" data-value="Нету, нужно создать">Нету, нужно создать</div>
                    <div class="btn-choice" data-value="Уже указывал">Уже указывал</div>
                </div>
                <input type="hidden" id="appleProfile" name="appleProfile">
                <div class="profile-input" id="appleInput">
                    <input type="text" id="appleProfileUrl" name="appleProfileUrl" placeholder="Ссылка">
                </div>
            </div>

            <!-- Ваш Telegram -->
            <div class="form-group">
                <label for="telegram" class="required">Ваш Telegram (@username или номер телефона)</label>
                <input type="text" id="telegram" name="telegram" placeholder="Ваш ответ" required>
            </div>

            <!-- Дополнительный комментарий -->
            <div class="form-group">
                <label for="comments">Доп. Комментарий к релизу (при необходимости)</label>
                <textarea id="comments" name="comments" rows="4" placeholder="Ваш ответ"></textarea>
            </div>

            <!-- Согласие с офертой -->
            <div class="agreement">
                <label>
                    <input type="checkbox" id="agreementCheckbox" required>
                    Я ознакомился и согласен с <a href="https://cdcult.ru/oferta" target="_blank" style="color: #4a90e2;">публичной офертой</a> и <a href="https://cdcult.ru/privacy-policy" target="_blank" style="color: #4a90e2;">политикой конфиденциальности</a>.
                </label>
            </div>

            <!-- Кнопка отправки -->
            <button type="submit" class="submit-btn">Отправить</button>
        </form>
    </div>

    <!-- --- НОВАЯ КНОПКА СТАТУС РЕЛИЗА --- -->
    <button class="status-btn" onclick="window.location.href='https://ch.cdcult.ru'">Статус релизов</button>

    <!-- Кнопка поддержки -->
    <button class="support-btn" onclick="window.location.href='https://cdcult_records.t.me'">Поддержка</button>

    <script>
        // Глобальный объект для хранения выбранных значений всех групп
        const selectedValues = {};

        // Функция для управления прямоугольными кнопками выбора
        function setupButtonGroup(buttonGroupClass, hiddenInputId) {
            const buttonGroup = document.querySelector(`${buttonGroupClass}`);
            const buttons = buttonGroup.querySelectorAll('.btn-choice');
            const hiddenInput = document.getElementById(hiddenInputId);

            const groupId = buttonGroup.getAttribute('data-group');

            if (!selectedValues[groupId]) {
                selectedValues[groupId] = '';
            }

            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    buttons.forEach(btn => btn.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedValues[groupId] = this.dataset.value;
                    hiddenInput.value = this.dataset.value;

                    handleSelection(groupId, this.dataset.value);
                });
            });
        }

        // Специальная функция для обработки изменений выбора
        function handleSelection(groupId, value) {
            if (groupId === 'transfer') {
                const transferFields = document.getElementById('transferFields');
                transferFields.style.display = value === 'Да' ? 'block' : 'none';
            }

            if (groupId === 'spotifyProfile') {
                document.getElementById('spotifyInput').style.display = value === 'Есть' ? 'block' : 'none';
            }

            if (groupId === 'appleProfile') {
                document.getElementById('appleInput').style.display = value === 'Есть' ? 'block' : 'none';
            }
        }

        // Инициализация всех групп кнопок
        setupButtonGroup('.button-group[data-group="releaseType"]', 'releaseType');
        setupButtonGroup('.button-group[data-group="transfer"]', 'transfer');
        setupButtonGroup('.button-group[data-group="profanity"]', 'profanity');
        setupButtonGroup('.button-group[data-group="spotifyProfile"]', 'spotifyProfile');
        setupButtonGroup('.button-group[data-group="appleProfile"]', 'appleProfile');

        // Обработчик отправки формы
        document.getElementById('distributionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Проверяем обязательные поля
            const requiredFields = document.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = 'red';
                } else {
                    field.style.borderColor = '#444';
                }
            });
            
            if (isValid) {
                // Собираем данные формы
                const formData = new FormData(this);
                const data = {};
                for (let [key, value] of formData.entries()) {
                    if (data[key]) {
                        if (!Array.isArray(data[key])) {
                            data[key] = [data[key]];
                        }
                        data[key].push(value);
                    } else {
                        data[key] = value;
                    }
                }

                // Отправляем данные на Google Apps Script
                sendEmail(data);
            } else {
                alert('Пожалуйста, заполните все обязательные поля.');
            }
        });

        // Функция отправки данных в Google Таблицу через Apps Script
        function sendEmail(formData) {
            // ВАЖНО: ЗАМЕНИТЕ ЭТОТ URL НА СКОПИРОВАННЫЙ ИЗ ШАГА 2!
            const googleScriptUrl = 'https://script.google.com/macros/s/AKfycbwyzf5lL5bbm9_axxDtstW5iG-ut8xXpozsHLjaoL_TW-2uBLzBd3NJGaGbSVcDFcY/exec';

            // Подготовим данные к отправке. FormData нужно преобразовать в объект.
            const plainFormData = {};
            for (let [key, value] of Object.entries(formData)) {
                if (Array.isArray(value)) {
                    plainFormData[key] = value.join(', '); // Преобразуем массивы в строки
                } else {
                    plainFormData[key] = value;
                }
            }

            // Отправляем данные на Google Apps Script
            fetch(googleScriptUrl, {
                method: 'POST',
                mode: 'no-cors', // Обход CORS - важно для внешнего запроса
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(plainFormData),
            })
            .then(response => {
                // mode: 'no-cors' не позволяет получить детали ответа, но успешная отправка работает
                alert('Спасибо за заполнение анкеты! Ваша заявка успешно отправлена.');
                resetForm(); // Вызываем функцию сброса формы
            })
            .catch(error => {
                console.error('Ошибка при отправке данных в Google Таблицу:', error);
                alert('Произошла ошибка при отправке формы. Пожалуйста, попробуйте позже или свяжитесь с нами напрямую.');
            });
        }

        // Функция сброса формы
        function resetForm() {
            document.getElementById('distributionForm').reset();
            document.querySelectorAll('.btn-choice.selected').forEach(btn => btn.classList.remove('selected'));
            document.getElementById('transferFields').style.display = 'none';
            document.getElementById('spotifyInput').style.display = 'none';
            document.getElementById('appleInput').style.display = 'none';
            Object.keys(selectedValues).forEach(key => selectedValues[key] = '');
        }
    </script>
</body>
</html>


